# ç›®æ¨™èˆ‡ç¯„åœ

**å¯¦ä½œé€²åº¦ï¼š0/12 æœå‹™å·²å®Œæˆ (0%)**

## A. ç›®æ¨™èˆ‡ç¯„åœ

**ç›®æ¨™**ï¼šåœ¨çœŸå¯¦äº¤æ˜“å‰ï¼Œå®Œæˆ S3ï¼ˆStrategy Engineï¼‰èˆ‡ S4ï¼ˆOrder Routerï¼‰çš„ç”Ÿç”¢ç´šè½åœ°ï¼š
L0 å®ˆé–€â†’è¦å‰‡ DSLâ†’ï¼ˆå¯æ¥ ML åˆ†æ•¸ï¼‰â†’ ç”¢ç”Ÿ FUT/SPOT ä¸‹å–®æ„åœ– â†’ æ™ºèƒ½åŸ·è¡Œï¼ˆMakerâ†’Takerã€TWAPã€OCO/SL/TPï¼‰â†’ äº‹ä»¶èˆ‡æŒä¹…åŒ– â†’ æŒ‡æ¨™èˆ‡å‘Šè­¦ã€‚

**ä¸åœ¨æœ¬æ³¢**ï¼šML è¨“ç·´ï¼ˆS9ï¼‰ã€å¾©ç›¤ï¼ˆS8ï¼‰å®Œæ•´ç”¢ç‰©ã€Promote æµç¨‹ï¼ˆS10 å…¨é‡ï¼‰ã€‚S3 å¯å…ˆæ”¯æ´ ML åˆ†æ•¸ç‚ºå¸¸æ•¸æˆ– Mock å€¼ã€‚

**å¯¦ä½œç‹€æ…‹**ï¼š
- âŒ **S3 Strategy Engine**ï¼šL0å®ˆé–€ã€è¦å‰‡DSLã€MLåˆ†æ•¸ã€ä¸‹å–®æ„åœ– **[æœªå¯¦ä½œ]**
- âŒ **S4 Order Router**ï¼šæ™ºèƒ½åŸ·è¡Œã€Makerâ†’Takerã€TWAPã€OCO/SL/TP **[æœªå¯¦ä½œ]**

## B. å‰ç½®ä¾è³´ï¼ˆå¯ Mockï¼‰

### ArangoDB âŒ **[æœªå¯¦ä½œ]**
- âŒ å·²å»º collections & ç´¢å¼•ï¼Œæˆ–ä»¥åˆå§‹åŒ–è…³æœ¬å…ˆå»ºç«‹
- âŒ `instrument_registry`ï¼ˆå– tickSize/stepSize/minNotional/spread/depth é–€æª»ï¼‰
- âŒ `factor_registry`ã€`strategy_rules`ã€`config_active/config_bundles`
- âŒ `signals`ã€`orders`ã€`fills`ã€`positions_snapshots`ã€`strategy_events`

### Redis Cluster âŒ **[æœªå¯¦ä½œ]**
- âŒ key/stream å·²åœ¨ v3 ç™½çš®æ›¸å®šç¾©
- âŒ **è®€**ï¼š`cfg:active_rev`ã€`cfg:events`ï¼ˆRCU ç†±è¼‰ï¼‰ã€`mkt:tick:{symbol}`ã€`mkt:depth:{symbol}`
- âŒ **å¯«**ï¼š`orders:intent`ã€`orders:executed`ã€`router:events`ã€`alerts`
- âŒ **åˆ†æ•£é–**ï¼š`lock:pos:{symbol}`ã€**å†ªç­‰**ï¼š`idem:order:{client_order_id}`

### é…ç½® âŒ **[æœªå¯¦ä½œ]**
- âŒ **ConfigMap**ï¼šS3_ / S4_ é–‹é ­ï¼ˆä¸‹æ–¹ã€Œç’°å¢ƒè®Šæ•¸ã€çµ¦å…¨è¡¨ï¼‰
- âŒ **äº¤æ˜“æ‰€é‡‘é‘°**ï¼ˆåƒ…åœ¨æœ€çµ‚æ¥ç·šä¸Šæ™‚å•Ÿç”¨ï¼‰
- âŒ å…ˆæ¥ Binance Testnet æˆ– Exchange Stub

## C. S3 Strategy Engine â€” ä»»å‹™åˆ†è§£ âŒ **[æœªå¯¦ä½œ]**

### C1. API èˆ‡å¥åº·æª¢æŸ¥ âŒ **[æœªå¯¦ä½œ]**

- âŒ **GET /health**ï¼šå›å‚³ä¾è³´ï¼ˆRedisã€Arangoã€Config revã€Rules loaded Nï¼‰
- âŒ **POST /decide**
  - **å…¥**ï¼š`{ symbol, sideHint?, dry_run?, context? }`
  - **å‡º**ï¼š`{ decision: open|skip, intent?, reason, config_rev, rules_fired[] }`
- âŒ **ï¼ˆå¯é¸ï¼‰POST /decide/batch**

### C2. Config Watcherï¼ˆRCU ç†±è¼‰ï¼‰âŒ **[æœªå¯¦ä½œ]**

- âŒ **ä¾†æº**ï¼š`config_active.rev`ï¼ˆArango/Redisï¼‰ï¼›äº‹ä»¶ï¼š`cfg:events`
- âŒ **æµç¨‹**ï¼šå–å¾— `bundle_id, rev` â†’ æ‹‰å– `strategy_rules/flags` â†’ æœ¬åœ° Lint å†æ›¿æ›
- âŒ **ç‰ˆæœ¬ä¸€è‡´æ€§**ï¼šé€²è¡Œä¸­åˆ¤æ–·ä½¿ç”¨èˆŠï¼›ä¸‹ä¸€ç­†åˆ‡æ–°ç‰ˆï¼›`signals.config_rev` è½åœ°

### C3. æ±ºç­–ç®¡ç·šï¼ˆæ¼”ç®—æ³•ï¼‰âŒ **[æœªå¯¦ä½œ]**

- âŒ **å–ç‰¹å¾µ**ï¼šå¾ `signals.features` æˆ–å³æ™‚è¨ˆç®—å¿«å–ï¼ˆ`feat:last:{symbol}`ï¼‰

- âŒ **L0 å®ˆé–€**ï¼š
  - `funding_next_abs â‰¤ max_funding_abs`
  - `spread_bps â‰¤ spread_bp_limit`ã€`depth_top1_usdt â‰¥ min`
  - é¢¨éšªé ç®—ï¼š`risk.budget.*`ã€`concurrent_entries_per_market`

- âŒ **L1 è¦å‰‡ DSL**ï¼ˆç™½åå–®ã€clampã€çŸ­è·¯ skip_entryï¼‰

- âŒ **L2 ML åˆ†æ•¸**ï¼ˆæš«ä»¥ mockï¼š`p=0.65 â†’ size_mult_ml=1.0`ï¼‰

- âŒ **Sizingï¼ˆFUTï¼‰**ï¼š`margin=20*size_mult`ï¼›`notional=margin*leverage`ï¼›`qty=round(notional/price, stepSize)`

- âŒ **SL/TP**ï¼š
  - `d_atr = ATR_mult*ATR`ï¼›`d_cap = max_loss_usdt/qty`ï¼›`d=min(...)`
  - å¤šå–®ï¼š`SL=entry-d`ï¼›TP ä»¥ã€Œæ·¨åˆ©â‰¥10%ã€åæ¨

- âŒ **SPOT**ï¼š`qty=floor(quote_budget/price, stepSize)`ï¼›OCO tp/sl ç”±ç­–ç•¥æˆ–å›ºå®šè·é›¢

- âŒ **æ„åœ–è¼¸å‡º**ï¼šFUT æˆ– SPOTï¼›é™„ `exec_policy`ï¼ˆMakerâ†’Taker/TWAP/OCOï¼‰èˆ‡ `client_order_id`

### C4. æŒä¹…åŒ–èˆ‡äº‹ä»¶ âŒ **[æœªå¯¦ä½œ]**

- âŒ `signals` å¯«å…¥ï¼š`{signal_id,t0,symbol,features,decision,config_rev}`
- âŒ ç™¼å¸ƒè‡³ `orders:intent`ï¼ˆStreamï¼‰èˆ‡ REST ç›´å‘¼ S4ï¼ˆå…©æ¢è·¯çš†å¯ï¼Œå»ºè­°é›™è»Œå…ˆä¿éšªï¼‰

### C5. å†ªç­‰ & é– âŒ **[æœªå¯¦ä½œ]**

- âŒ `client_order_id` ç”Ÿæˆè¦å‰‡ï¼š`{svc}-btc-TS-rand`ï¼›Redis `SETNX idem:order:{id}=1 ttl=1h`
- âŒ åŒ symbol å–®æ¬¡æ±ºç­–ï¼š`lock:pos:{symbol}`ï¼ˆæœ€å¤§ 3sï¼‰ï¼Œé¿å…é‡è¦† open

### C6. æŒ‡æ¨™èˆ‡å‘Šè­¦ âŒ **[æœªå¯¦ä½œ]**

- âŒ `strategy.decide.latency_ms`ã€`rules.fired.count`ã€`gate.skip.count`
- âŒ **å‘Šè­¦**ï¼šç„¡è¦å‰‡å¯ç”¨ã€é…ç½®èˆ‡æœ¬åœ° rev ä¸ä¸€è‡´ã€æ±ºç­–ç”¢ç”Ÿä½†ç™¼å¸ƒå¤±æ•—

### C7. æ¸¬è©¦èˆ‡é©—æ”¶ âŒ **[æœªå¯¦ä½œ]**

- âŒ **å–®å…ƒ**ï¼šL0/L1/L2ã€sizingã€SL/TP åè§£ã€clampã€skip çŸ­è·¯
- âŒ **å¥‘ç´„**ï¼šPOST /decide schema æ­£ç¢ºï¼›dry_run ä¸è½åœ° intent
- âŒ **æ•´åˆ**ï¼šèˆ‡ S4 stubï¼›äº‚æµï¼ˆspread/depth ç•°å¸¸ï¼‰èƒ½æ­£ç¢º skip

- âŒ **é©—æ”¶ï¼ˆReadyï¼‰**
  - 1000 ç­†æ¨¡æ“¬ç‰¹å¾µæ±ºç­– â‰¤ 200ms/P50ã€â‰¤ 500ms/P95
  - é¢¨éšªå®ˆé–€å…¨è¦†è“‹ï¼›æ±ºç­–è½ signals ä¸” config_rev æ­£ç¢º
  - æ„åœ–å¯åŒæ™‚èµ° REST èˆ‡ Streamï¼›å†ªç­‰ç”Ÿæ•ˆ

## D. S4 Order Router â€” ä»»å‹™åˆ†è§£ âŒ **[æœªå¯¦ä½œ]**

### D1. API èˆ‡å¥åº·æª¢æŸ¥ âŒ **[æœªå¯¦ä½œ]**

- âŒ **GET /health**ï¼šé€£ç·šï¼ˆExchã€Redisã€Arangoï¼‰ã€è·¯ç”±è¡¨ revã€CB ç‹€æ…‹
- âŒ **POST /orders**

**å…¥ï¼ˆFUTï¼‰**ï¼š
```json
{
  "intent_id":"uuid","market":"FUT","symbol":"BTCUSDT","side":"BUY",
  "qty":0.002,"exec_policy":{"maker_wait_ms":2000,"twap":{"slices":2,"gap_ms":600}},
  "sl":{"type":"STOP_MARKET","price":64800},
  "tp":{"type":"TAKE_PROFIT_MARKET","target":"net_profit_usdt","value":2.0},
  "client_order_id":"s3-btc-...","reduce_only":false
}
```

**å…¥ï¼ˆSPOT-OCOï¼‰**ï¼š
```json
{
  "intent_id":"uuid","market":"SPOT","symbol":"BTCUSDT","side":"BUY",
  "qty":0.003,"exec_policy":{"type":"OCO","tp_price":67000,"sl_price":64500},
  "client_order_id":"s3-btc-..."
}
```

- âŒ **å‡º**ï¼š`{ result: OK|FAIL, order_ids[], message? }`
- âŒ **POST /cancel**ï¼šæŒ‰ order_id æˆ– client_order_id æ’¤å–®

### D2. è·¯ç”±ç­–ç•¥ï¼ˆMakerâ†’Taker / TWAP / æµå‹•æ€§æ¢æ¸¬ï¼‰âŒ **[æœªå¯¦ä½œ]**

- âŒ **Maker ç­‰å¾…** `wait_ms = f(notional)`ï¼ˆè·¯ç”±è¡¨ï¼‰
- âŒ ä¸è¶³é‡æˆ–è¶…æ™‚ â†’ cancel â†’ å¸‚åƒ¹ï¼ˆæˆ–é™åƒ¹è¿½ 1 æª”ï¼‰
- âŒ **TWAP**ï¼šæŒ‰ slices/gap_ms åˆ‡ç‰‡ï¼Œæ”¯æ´ Â± æŠ–å‹•
- âŒ **æµå‹•æ€§æ¢æ¸¬**ï¼šä¸‹å–®å‰æŸ¥ spread_bpsã€top1_depthï¼›éé–¾å€¼å»¶æ™‚æˆ–æ”¹æ‹†å–®

### D3. äº¤æ˜“è¦å‰‡èˆ‡ rounding âŒ **[æœªå¯¦ä½œ]**

- âŒ æª¢æŸ¥ minNotionalã€tickSize/stepSizeï¼›round_to_tick/step
- âŒ **FUT**ï¼šè¨­ marginType=ISOLATEDã€leverage=20ï¼ˆè‹¥å°šæœªè¨­ï¼‰
- âŒ **FUT**ï¼šå¸‚åƒ¹é–‹å€‰æˆäº¤å¾Œï¼Œç«‹å³ä¸‹ STOP_MARKETï¼ˆworkingType=MARK_PRICEã€reduceOnlyï¼‰
- âŒ **TP**ï¼šTAKE_PROFIT_MARKET æˆ–ç”± S6 ç®¡ç†ï¼ˆæœ¬æ³¢å¯å…ˆç”± S4 æŒ‚å–®ï¼‰
- âŒ **SPOT**ï¼šäº¤æ˜“æ‰€ OCO æ”¯æ´å‰‡ç›´ç”¨ï¼›å¦å‰‡ å®¢æˆ¶ç«¯å®ˆè­·ï¼ˆWS/è¼ªå·¡ï¼‰ç¢ºä¿ä¸€è…¿æˆäº¤å¦ä¸€è…¿æ’¤éŠ·

### D4. å†ªç­‰ï¼ç†”æ–·ï¼éŒ¯èª¤é‡è©¦ âŒ **[æœªå¯¦ä½œ]**

- âŒ `idem:order:{client_order_id}` ä¿è­‰ä¸€æ¬¡æ€§
- âŒ **ç†”æ–·**ï¼šè¿‘ 60s å…§ 5xx/429 è¶…é–¾å€¼ â†’ CB=OPENï¼ˆæš«åœæ–°é–‹ï¼Œå…è¨±å¹³å€‰èˆ‡é¢¨éšªæ“ä½œï¼‰
- âŒ **é‡è©¦**ï¼šç¶²è·¯è¶…æ™‚ N æ¬¡å…§é€€é¿é‡è©¦ï¼›é‡è©¦ä»å¤±æ•— â†’ ç™¼ alerts

### D5. äº‹ä»¶èˆ‡æŒä¹…åŒ– âŒ **[æœªå¯¦ä½œ]**

- âŒ å¯« orders/fillsï¼›Stream `orders:executed`ã€`router:events`
- âŒ fills è¨˜éŒ„ mid_at_sendã€book_top3ã€slippage_bps
- âŒ **OCO å®ˆè­·**ï¼šç¶­æŒå…§éƒ¨ç‹€æ…‹æ©Ÿï¼›ä»»ä½•è…¿æˆäº¤â†’å¦ä¸€è…¿æ’¤éŠ·ï¼›å¯« strategy_events

### D6. æŒ‡æ¨™èˆ‡å‘Šè­¦ âŒ **[æœªå¯¦ä½œ]**

- âŒ `router.submit.latency_ms`ï¼ˆP50/P95ï¼‰ã€`maker.fill_ratio`ã€`twap.slice_fill_ratio`
- âŒ `taker.rate`ã€`slippage.bps.p50/p95`ã€`fee.usdt.total`
- âŒ **å‘Šè­¦**ï¼šCB é–‹å•Ÿã€maker_fill_ratio é•·æœŸéä½ã€insufficient_balance_rate éé«˜

### D7. æ¸¬è©¦èˆ‡é©—æ”¶ âŒ **[æœªå¯¦ä½œ]**

- âŒ **å–®å…ƒ**ï¼šå››æ¨äº”å…¥ã€æœ€å°å–®ä½ã€OCO å®ˆè­·ç‹€æ…‹æ©Ÿã€Makerâ†’Taker å›é€€
- âŒ **å¥‘ç´„**ï¼š/orders å…¥å‡º schemaï¼›/cancel å¤šå ´æ™¯
- âŒ **æ•´åˆ**ï¼šä¸²æ¥ Sandbox æˆ– Stubï¼Œé©—è­‰ SL/TP/ReduceOnly è¡Œç‚º

- âŒ **é©—æ”¶ï¼ˆReadyï¼‰**
  - 1000 ç­†é€£çºŒæ„åœ–ï¼šæˆåŠŸä¸‹å–® â‰¥ 99%ï¼Œå¹³å‡å»¶é² P95 â‰¤ 500ms
  - å¸‚å ´æ¥µç«¯ï¼ˆå¤§ spread/è–„æ·±åº¦ï¼‰èƒ½è‡ªå‹•å»¶æ™‚/æ‹†åˆ†/é™ç´š
  - OCO å®ˆè­· 100% ä¸€è…¿æˆäº¤å¦ä¸€è…¿æ’¤éŠ·ï¼›ç„¡é‡è¦†æˆäº¤

## E. ç’°å¢ƒè®Šæ•¸ / ConfigMapï¼ˆS3/S4ï¼‰âŒ **[æœªå¯¦ä½œ]**

### S3 âŒ **[æœªå¯¦ä½œ]**
- âŒ `S3_DB_ARANGO_URI`ã€`S3_DB_ARANGO_USER/PASS`
- âŒ `S3_REDIS_ADDRESSES`ï¼ˆé€—è™Ÿåˆ†éš”ï¼ŒCluster æ¨¡å¼ï¼‰
- âŒ `S3_SYMBOLS`ï¼ˆé è¨­ï¼šBTCUSDTï¼Œå¯å¤šï¼‰
- âŒ `S3_MAX_FUNDING_ABS`ï¼ˆä¾‹ 0.0005ï¼‰
- âŒ `S3_SPREAD_BP_LIMIT_DEFAULT`ã€`S3_DEPTH_TOP1_USDT_MIN_DEFAULT`
- âŒ `S3_LEVERAGE_DEFAULT=20`ã€`S3_MARGIN_BASE_USDT=20`
- âŒ `S3_MAX_LOSS_USDT=1.2`ã€`S3_ATR_MULT=1.5`
- âŒ `S3_CONCURRENT_ENTRIES_PER_MARKET=1`
- âŒ `S3_CONFIG_POLL_SEC=5`

### S4 âŒ **[æœªå¯¦ä½œ]**
- âŒ `S4_EXCHANGE=binance`ã€`S4_BINANCE_KEY/SECRET`ã€`S4_TESTNET=true`
- âŒ `S4_REDIS_ADDRESSES`ã€`S4_DB_ARANGO_*`
- âŒ `S4_ROUTE_TABLE_PATH=/etc/chimera/route.json`
- âŒ `S4_CB_ERROR_RATE_WINDOW=60s`ã€`S4_CB_ERROR_RATE_THRESH=0.2`
- âŒ `S4_MAKER_MAX_WAIT_MS=3000`ã€`S4_TWAP_MAX_SLICES=4`
- âŒ `S4_OCO_GUARDIAN=true`
- âŒ `S4_WORKING_TYPE=MARK_PRICE`

## F. å…¸å‹é©—æ”¶æƒ…å¢ƒï¼ˆHappy + Edgeï¼‰

### FUTï¼ˆHappyï¼‰âŒ **[æœªå¯¦ä½œ]**
- âŒ `/decide` å‘½ä¸­è¦å‰‡ â†’ open BUYã€size_mult=1.0 â†’ ç™¼ `/orders`
- âŒ å¸‚åƒ¹æˆäº¤ â†’ STOP_MARKET æˆåŠŸæ›ä¸Š â†’ TAKE_PROFIT_MARKET æˆåŠŸæ›ä¸Š
- âŒ orders/fills æ­£ç¢ºè½åœ°ï¼›orders:executed ç™¼é€
- âŒ æŒ‡æ¨™ï¼šP95 â‰¤ 500msï¼›slippage_bps åœ¨åŸºæº–å€é–“

### FUTï¼ˆEdgeï¼‰âŒ **[æœªå¯¦ä½œ]**
- âŒ spread 2Ã— å¹³å‡ã€æ·±åº¦ä¸è¶³ â†’ S3 skip **[S3æœªå¯¦ä½œ]**
- âŒ äº¤æ˜“æ‰€ 429/5xx â†’ S4 é‡è©¦ä¸¦å¯èƒ½ CB=OPENï¼Œå°å¤–è¿”å› FAIL èˆ‡å‘Šè­¦ **[S4æœªå¯¦ä½œ]**

### SPOT OCOï¼ˆHappyï¼‰âŒ **[æœªå¯¦ä½œ]**
- âŒ `/decide` market=SPOT â†’ `/orders`ï¼ˆOCOï¼‰
- âŒ ä¸€è…¿æˆäº¤ â†’ å®ˆè­·æ’¤éŠ·å¦ä¸€è…¿ï¼›è½åœ° fillsï¼›strategy_events è¨˜éŒ„ OCO_RESOLVE

### SPOT OCOï¼ˆEdgeï¼‰âŒ **[æœªå¯¦ä½œ]**
- âŒ äº¤æ˜“æ‰€ä¸æ”¯æ´ OCO â†’ OCO_GUARDIAN æ¥ç®¡ï¼›WS ä¸­æ–·æœŸé–“ç”¨è¼ªå·¡ç¢ºä¿æ’¤éŠ·

### å†ªç­‰ âŒ **[æœªå¯¦ä½œ]**
- âŒ `/orders` ç›¸åŒ client_order_id é‡é€ â†’ S4 ç›´æ¥å›è¦†å·²å­˜åœ¨/æ‹’çµ•ï¼Œç„¡é‡è¤‡ä¸‹å–®

## G. æ¨£æœ¬ Fixturesï¼ˆä¾›å–®å…ƒ/æ•´åˆæ¸¬è©¦ï¼‰âŒ **[æœªå¯¦ä½œ]**

### instrument_registryï¼ˆBTCUSDTï¼‰âŒ **[æœªå¯¦ä½œ]**
```json
{
  "symbol":"BTCUSDT","tickSize":1,"stepSize":0.001,"minNotional":5,
  "spread_bp_limit":3,"depth_top1_usdt_min":200
}
```

### è¦å‰‡ï¼ˆstrategy_rulesï¼‰âŒ **[æœªå¯¦ä½œ]**
```json
{
  "rule_id":"R-023","priority":50,
  "applies":{"symbols":["BTCUSDT"],"services":["s3-strategy"]},
  "when":{"allOf":[{"f":"rv_pctile_30d","op":"<","v":0.25},{"f":"rho_usdttwd_14","op":"<","v":-0.3}]},
  "action":{"type":"size_mult","value":1.2},"status":"ENABLED"
}
```

### è·¯ç”±è¡¨ï¼ˆS4ï¼‰âŒ **[æœªå¯¦ä½œ]**
```json
[
  {"notional_usdt_max":200,"maker_wait_ms":1500,"twap":{"slices":1,"gap_ms":0}},
  {"notional_usdt_max":500,"maker_wait_ms":2000,"twap":{"slices":2,"gap_ms":600}}
]
```

## H. é¢¨éšªèˆ‡ç·©è§£

- âŒ **æ™‚é˜åç§»**ï¼šä¸‹å–®å‰å…ˆæ¯”å° serverTimeï¼Œåç§»>1s åœæ–°å€‰ **[S4æœªå¯¦ä½œ]**
- âŒ **è³‡é‡‘ä¸è¶³**ï¼šåµæ¸¬åˆ° insufficient balance â†’ é™é¡å†è©¦ï¼›é€£çºŒå¤±æ•— â†’ å‘Šè­¦ **[S4æœªå¯¦ä½œ]**
- âŒ **è¦å‰‡/é…ç½®ç¼ºå¤±**ï¼šç„¡ ENALBED è¦å‰‡æˆ– factor ç¼º â†’ ç›´æ¥ skip + alert **[S3æœªå¯¦ä½œ]**
- âŒ **ç¶²è·¯æ³¢å‹•**ï¼šæ‰€æœ‰ REST èª¿ç”¨é€€é¿é‡è©¦ï¼›WebSocket è‡ªå‹•é‡é€£ **[S1æœªå¯¦ä½œ]**
- âŒ **Redis Cluster slot ç§»è½‰**ï¼šä½¿ç”¨å®˜æ–¹ cluster clientï¼›é—œéµæ“ä½œå…·é‡è©¦ç­–ç•¥ **[S1-S3æœªå¯¦ä½œ]**

## I. äº¤ä»˜ç‰©æ¸…å–®ï¼ˆæœ¬æ³¢å®Œæˆæ‰ç®— Doneï¼‰

- âŒ S3 å¯åŸ·è¡Œæœå‹™ï¼ˆæœ‰ GET /healthã€POST /decideã€RCU ç†±è¼‰ã€signals è½åœ°ï¼‰**[æœªå¯¦ä½œ]**
- âŒ S4 å¯åŸ·è¡Œæœå‹™ï¼ˆæœ‰ GET /healthã€POST /ordersã€/cancelã€Makerâ†’Takerã€TWAPã€SPOT OCO/å®ˆè­·ã€FUT SL/TP æŒ‚å–®ï¼‰**[æœªå¯¦ä½œ]**
- âŒ é…ç½®èˆ‡è·¯ç”±è¡¨ï¼ˆConfigMap / Secretï¼‰**[æœªå¯¦ä½œ]**
- âŒ å¥‘ç´„æ¸¬è©¦ï¼ˆschema é©—è­‰ã€è‡ªå‹•åŒ– happy/edge casesï¼‰**[æœªå¯¦ä½œ]**
- âŒ è§€æ¸¬æ€§ï¼ˆæ ¸å¿ƒ SLI æŒ‡æ¨™ä¸Šå ±ï¼›å‘Šè­¦åˆ° alerts streamï¼‰**[æœªå¯¦ä½œ]**
- âŒ Runbookï¼ˆCB é–‹å•Ÿ/é—œé–‰ã€OCO å®ˆè­·ç•°å¸¸ã€æ’¤èˆŠæ›æ–°æ•…éšœè™•ç†ï¼‰**[æœªå¯¦ä½œ]**

## J. å¿«é€Ÿè‡ªæ¸¬ï¼ˆcurl ç¯„ä¾‹ï¼‰

### S3 æ±ºç­–ï¼ˆdry runï¼‰âŒ **[æœªå¯¦ä½œ]**
```bash
curl -X POST http://s3:8080/decide -H 'content-type: application/json' \
  -d '{"symbol":"BTCUSDT","dry_run":true}'
```

### S4 FUT ä¸‹å–® âŒ **[æœªå¯¦ä½œ]**
```bash
curl -X POST http://s4:8080/orders -H 'content-type: application/json' \
  -d '{"intent_id":"uuid-1","market":"FUT","symbol":"BTCUSDT","side":"BUY","qty":0.002,
       "exec_policy":{"maker_wait_ms":2000,"twap":{"slices":2,"gap_ms":600}},
       "sl":{"type":"STOP_MARKET","price":64800}, "client_order_id":"s3-btc-16900001"}'
```

### S4 SPOT OCO âŒ **[æœªå¯¦ä½œ]**
```bash
curl -X POST http://s4:8080/orders -H 'content-type: application/json' \
  -d '{"intent_id":"uuid-2","market":"SPOT","symbol":"BTCUSDT","side":"BUY","qty":0.003,
       "exec_policy":{"type":"OCO","tp_price":67000,"sl_price":64500},
       "client_order_id":"s3-btc-16900002"}'
```

### å¥åº·æª¢æŸ¥ âŒ **[æœªå¯¦ä½œ]**
```bash
curl http://s3:8080/health
curl http://s4:8080/health
```

---

## ğŸ“Š å¯¦ä½œé€²åº¦ç¸½çµ

### âŒ å…¨éƒ¨æœªå¯¦ä½œ (0%)
- **S3 Strategy Engine**ï¼šæ±ºç­–ç®¡ç·šã€APIã€å¥åº·æª¢æŸ¥ã€é…ç½®ç†±è¼‰
- **S4 Order Router**ï¼šè¨‚å–®åŸ·è¡Œã€è·¯ç”±ç­–ç•¥ã€äº¤æ˜“è¦å‰‡ã€å†ªç­‰/ç†”æ–·
- **å‰ç½®ä¾è³´**ï¼šArangoDBã€Redis Clusterã€é…ç½®ç®¡ç†
- **æ¨£æœ¬Fixtures**ï¼šinstrument_registryã€strategy_rules
- **é¢¨éšªç·©è§£**ï¼šè¦å‰‡/é…ç½®ç¼ºå¤±ã€ç¶²è·¯æ³¢å‹•ã€Redis Cluster
- **é©—æ”¶æƒ…å¢ƒ**ï¼šFUT/SPOTå®Œæ•´æµç¨‹ã€é‚Šç•Œæƒ…æ³è™•ç†
- **äº¤ä»˜ç‰©**ï¼šS3/S4æœå‹™ã€Runbook
- **è‡ªæ¸¬ç¯„ä¾‹**ï¼šS3/S4 APIèª¿ç”¨

### ğŸ¯ å»ºè­°å„ªå…ˆé †åº
1. **å‰ç½®ä¾è³´** - ArangoDBã€Redis Clusterã€é…ç½®ç®¡ç†
2. **S3 Strategy Engine** - æ±ºç­–ç®¡ç·šæ ¸å¿ƒ
3. **S4 Order Router** - è¨‚å–®åŸ·è¡Œæ ¸å¿ƒ
4. **é©—æ”¶æƒ…å¢ƒ** - å®Œæ•´æµç¨‹æ¸¬è©¦
5. **äº¤ä»˜ç‰©** - ç”Ÿç”¢ç´šéƒ¨ç½²
6. **Runbook** - é‹ç¶­æ–‡æª”